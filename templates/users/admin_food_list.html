{% extends 'base.html' %}
{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
  <h2>Glutensiz Gıdalar</h2>
  <form method="get" class="d-flex flex-wrap gap-2 align-items-center" style="min-width:400px;">
    <div class="input-group">
      <input type="text" name="q" value="{{ request.GET.q|default:'' }}" class="form-control" placeholder="İsim, marka veya kategori ara...">
    </div>
    <select name="brand" class="form-select" style="min-width:120px;">
      <option value="">Tüm Markalar</option>
      {% for brand in brands %}
        <option value="{{ brand.id }}" {% if request.GET.brand == brand.id|stringformat:'s' %}selected{% endif %}>{{ brand.name }}</option>
      {% endfor %}
    </select>
    <select name="category" class="form-select" style="min-width:120px;">
      <option value="">Tüm Kategoriler</option>
      {% for category in categories %}
        <option value="{{ category.id }}" {% if request.GET.category == category.id|stringformat:'s' %}selected{% endif %}>{{ category.name }}</option>
      {% endfor %}
    </select>
    <select name="is_approved" class="form-select" style="min-width:120px;">
      <option value="">Hepsi</option>
      <option value="true" {% if request.GET.is_approved == 'true' %}selected{% endif %}>Onaylı</option>
      <option value="false" {% if request.GET.is_approved == 'false' %}selected{% endif %}>Onaysız</option>
    </select>
    <button class="btn btn-outline-secondary" type="submit">Filtrele</button>
  </form>
  <a href="{% url 'admin_food_create' %}" class="btn btn-success">Yeni Ekle</a>
</div>
<table class="table table-striped">
  <thead>
    <tr>
      <th>İsim</th>
      <th>Marka</th>
      <th>Kategori</th>
      <th>Onaylı mı?</th>
      <th>Ekleyen</th>
      <th>İşlemler</th>
    </tr>
  </thead>
  <tbody>
    {% for food in foods %}
    <tr>
      <td>{{ food.name }}</td>
      <td>{{ food.brand }}</td>
      <td>{{ food.category }}</td>
      <td>{% if food.is_approved %}Evet{% else %}Hayır{% endif %}</td>
      <td>{% if food.added_by %}{{ food.added_by }}{% else %}—{% endif %}</td>
      <td>
        <a href="{% url 'admin_food_update' food.pk %}" class="btn btn-sm btn-primary">Düzenle</a>
        <a href="{% url 'admin_food_delete' food.pk %}" class="btn btn-sm btn-danger">Sil</a>
      </td>
    </tr>
    {% empty %}
    <tr><td colspan="6">Kayıt bulunamadı.</td></tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %} 